(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{417:function(t,s,a){t.exports=a.p+"assets/img/3.14_forward.0eeff0cb.svg"},544:function(t,s,a){"use strict";a.r(s);var i=a(46),l=Object(i.a)({},(function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[i("h1",{attrs:{id:"正向传播、反向传播和计算图"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#正向传播、反向传播和计算图"}},[t._v("#")]),t._v(" 正向传播、反向传播和计算图")]),t._v(" "),i("p",[t._v("前面几节里我们使用了小批量随机梯度下降的优化算法来训练模型。在实现中，我们只提供了模型的正向传播（forward propagation）的计算，即对输入计算模型输出，然后通过"),i("code",[t._v("tap.gradient()")]),t._v("函数计算梯度。基于反向传播（back-propagation）算法的自动求梯度极大简化了深度学习模型训练算法的实现。本节我们将使用数学和计算图（computational graph）两个方式来描述正向传播和反向传播。具体来说，我们将以带"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("msub",[i("mi",[t._v("L")]),i("mn",[t._v("2")])],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("L_2")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.83333em","vertical-align":"-0.15em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathnormal"},[t._v("L")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.30110799999999993em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[t._v("2")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])])])])]),t._v("范数正则化的含单隐藏层的多层感知机为样例模型解释正向传播和反向传播。")]),t._v(" "),i("h2",{attrs:{id:"正向传播"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#正向传播"}},[t._v("#")]),t._v(" 正向传播")]),t._v(" "),i("p",[t._v("正向传播是指对神经网络沿着从输入层到输出层的顺序，依次计算并存储模型的中间变量（包括输出）。为简单起见，假设输入是一个特征为"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("x")]),i("mo",[t._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[t._v("R")]),i("mi",[t._v("d")])],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\boldsymbol{x} \\in \\mathbb{R}^d")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.5782em","vertical-align":"-0.0391em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("x")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.849108em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[t._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.849108em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[t._v("d")])])])])])])])])])])]),t._v("的样本，且不考虑偏差项，那么中间变量")]),t._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("z")]),i("mo",[t._v("=")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("1")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("x")]),i("mo",{attrs:{separator:"true"}},[t._v(",")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\boldsymbol{z} = \\boldsymbol{W}^{(1)} \\boldsymbol{x},\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.44444em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.04213em"}},[t._v("z")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.15845em","vertical-align":"-0.19444em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("1")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("x")])])]),i("span",{staticClass:"mpunct"},[t._v(",")])])])])])]),t._v(" "),i("p",[t._v("其中"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("1")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("mo",[t._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[t._v("R")]),i("mrow",[i("mi",[t._v("h")]),i("mo",[t._v("×")]),i("mi",[t._v("d")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\boldsymbol{W}^{(1)} \\in \\mathbb{R}^{h \\times d}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.00311em","vertical-align":"-0.0391em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("1")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8491079999999999em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[t._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.8491079999999999em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[t._v("h")]),i("span",{staticClass:"mbin mtight"},[t._v("×")]),i("span",{staticClass:"mord mathnormal mtight"},[t._v("d")])])])])])])])])])])])]),t._v("是隐藏层的权重参数。把中间变量"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("z")]),i("mo",[t._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[t._v("R")]),i("mi",[t._v("h")])],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\boldsymbol{z} \\in \\mathbb{R}^h")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.5782em","vertical-align":"-0.0391em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.04213em"}},[t._v("z")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.849108em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[t._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.849108em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[t._v("h")])])])])])])])])])])]),t._v("输入按元素运算的激活函数"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("ϕ")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\phi")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("ϕ")])])])]),t._v("后，将得到向量长度为"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("h")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("h")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("h")])])])]),t._v("的隐藏层变量")]),t._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("h")]),i("mo",[t._v("=")]),i("mi",[t._v("ϕ")]),i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("z")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v(".")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\boldsymbol{h} = \\phi (\\boldsymbol{z}).\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("h")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("ϕ")]),i("span",{staticClass:"mopen"},[t._v("(")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.04213em"}},[t._v("z")])])]),i("span",{staticClass:"mclose"},[t._v(")")]),i("span",{staticClass:"mord"},[t._v(".")])])])])])]),t._v(" "),i("p",[t._v("隐藏层变量"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("h")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\boldsymbol{h}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("h")])])])])])]),t._v("也是一个中间变量。假设输出层参数只有权重"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("mo",[t._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[t._v("R")]),i("mrow",[i("mi",[t._v("q")]),i("mo",[t._v("×")]),i("mi",[t._v("h")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\boldsymbol{W}^{(2)} \\in \\mathbb{R}^{q \\times h}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.00311em","vertical-align":"-0.0391em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8491079999999999em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[t._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.8491079999999999em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03588em"}},[t._v("q")]),i("span",{staticClass:"mbin mtight"},[t._v("×")]),i("span",{staticClass:"mord mathnormal mtight"},[t._v("h")])])])])])])])])])])])]),t._v("，可以得到向量长度为"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("q")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("q")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03588em"}},[t._v("q")])])])]),t._v("的输出层变量")]),t._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("o")]),i("mo",[t._v("=")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("h")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v(".")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\boldsymbol{o} = \\boldsymbol{W}^{(2)} \\boldsymbol{h}.\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.44444em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("o")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.96401em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("h")])])]),i("span",{staticClass:"mord"},[t._v(".")])])])])])]),t._v(" "),i("p",[t._v("假设损失函数为"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("ℓ")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\ell")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[t._v("ℓ")])])])]),t._v("，且样本标签为"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("y")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("y")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")])])])]),t._v("，可以计算出单个数据样本的损失项")]),t._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mi",[t._v("L")]),i("mo",[t._v("=")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("ℓ")]),i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("o")]),i("mo",{attrs:{separator:"true"}},[t._v(",")]),i("mi",[t._v("y")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v(".")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("L = \\ell(\\boldsymbol{o}, y).\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("L")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord"},[t._v("ℓ")]),i("span",{staticClass:"mopen"},[t._v("(")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("o")])])]),i("span",{staticClass:"mpunct"},[t._v(",")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03588em"}},[t._v("y")]),i("span",{staticClass:"mclose"},[t._v(")")]),i("span",{staticClass:"mord"},[t._v(".")])])])])])]),t._v(" "),i("p",[t._v("根据"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("msub",[i("mi",[t._v("L")]),i("mn",[t._v("2")])],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("L_2")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.83333em","vertical-align":"-0.15em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathnormal"},[t._v("L")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.30110799999999993em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[t._v("2")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])])])])]),t._v("范数正则化的定义，给定超参数"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("λ")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\lambda")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("λ")])])])]),t._v("，正则化项即")]),t._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mi",[t._v("s")]),i("mo",[t._v("=")]),i("mfrac",[i("mi",[t._v("λ")]),i("mn",[t._v("2")])],1),i("mrow",[i("mo",{attrs:{fence:"true"}},[t._v("(")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("∥")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("1")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("msubsup",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∥")]),i("mi",[t._v("F")]),i("mn",[t._v("2")])],1),i("mo",[t._v("+")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("∥")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("msubsup",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∥")]),i("mi",[t._v("F")]),i("mn",[t._v("2")])],1),i("mo",{attrs:{fence:"true"}},[t._v(")")])],1),i("mo",{attrs:{separator:"true"}},[t._v(",")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("s = \\frac{\\lambda}{2} \\left(\\|\\boldsymbol{W}^{(1)}\\|_F^2 + \\|\\boldsymbol{W}^{(2)}\\|_F^2\\right),\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("s")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.05744em","vertical-align":"-0.686em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[t._v("2")])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathnormal"},[t._v("λ")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"minner"},[i("span",{staticClass:"mopen delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size2"},[t._v("(")])]),i("span",{staticClass:"mord"},[t._v("∥")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("1")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[t._v("∥")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.8641079999999999em"}},[i("span",{staticStyle:{top:"-2.4530000000000003em","margin-left":"0em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.13889em"}},[t._v("F")])])]),i("span",{staticStyle:{top:"-3.113em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[t._v("2")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.247em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[t._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mord"},[t._v("∥")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[t._v("∥")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.8641079999999999em"}},[i("span",{staticStyle:{top:"-2.4530000000000003em","margin-left":"0em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.13889em"}},[t._v("F")])])]),i("span",{staticStyle:{top:"-3.113em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[t._v("2")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.247em"}},[i("span")])])])])]),i("span",{staticClass:"mclose delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size2"},[t._v(")")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mpunct"},[t._v(",")])])])])])]),t._v(" "),i("p",[t._v("其中矩阵的Frobenius范数等价于将矩阵变平为向量后计算"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("msub",[i("mi",[t._v("L")]),i("mn",[t._v("2")])],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("L_2")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.83333em","vertical-align":"-0.15em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathnormal"},[t._v("L")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.30110799999999993em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[t._v("2")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])])])])]),t._v("范数。最终，模型在给定的数据样本上带正则化的损失为")]),t._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mi",[t._v("J")]),i("mo",[t._v("=")]),i("mi",[t._v("L")]),i("mo",[t._v("+")]),i("mi",[t._v("s")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v(".")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("J = L + s.\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.76666em","vertical-align":"-0.08333em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("L")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[t._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("s")]),i("span",{staticClass:"mord"},[t._v(".")])])])])])]),t._v(" "),i("p",[t._v("我们将"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("J")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("J")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),t._v("称为有关给定数据样本的目标函数，并在以下的讨论中简称目标函数。")]),t._v(" "),i("h2",{attrs:{id:"正向传播的计算图"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#正向传播的计算图"}},[t._v("#")]),t._v(" 正向传播的计算图")]),t._v(" "),i("p",[t._v("我们通常绘制计算图来可视化运算符和变量在计算中的依赖关系。下图绘制了本节中样例模型正向传播的计算图，其中左下角是输入，右上角是输出。可以看到，图中箭头方向大多是向右和向上，其中方框代表变量，圆圈代表运算符，箭头表示从输入到输出之间的依赖关系。了解更多关于计算图的知识，可以参考"),i("RouterLink",{attrs:{to:"/ch-1/tensorflow-strategy.html"}},[t._v("TensorFLow编程策略：计算图和模型表示")]),t._v("。")],1),t._v(" "),i("p",[i("img",{attrs:{src:a(417),alt:"img"}})]),t._v(" "),i("h2",{attrs:{id:"反向传播"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#反向传播"}},[t._v("#")]),t._v(" 反向传播")]),t._v(" "),i("p",[t._v("反向传播指的是计算神经网络参数梯度的方法。总的来说，反向传播依据微积分中的链式法则，沿着从输出层到输入层的顺序，依次计算并存储目标函数有关神经网络各层的中间变量以及参数的梯度。对输入或输出"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"sans-serif"}},[t._v("X")]),i("mo",{attrs:{separator:"true"}},[t._v(",")]),i("mi",{attrs:{mathvariant:"sans-serif"}},[t._v("Y")]),i("mo",{attrs:{separator:"true"}},[t._v(",")]),i("mi",{attrs:{mathvariant:"sans-serif"}},[t._v("Z")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\mathsf{X}, \\mathsf{Y}, \\mathsf{Z}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),i("span",{staticClass:"mord mathsf"},[t._v("X")]),i("span",{staticClass:"mpunct"},[t._v(",")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mord mathsf",staticStyle:{"margin-right":"0.025em"}},[t._v("Y")]),i("span",{staticClass:"mpunct"},[t._v(",")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mord mathsf"},[t._v("Z")])])])]),t._v("为任意形状张量的函数"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"sans-serif"}},[t._v("Y")]),i("mo",[t._v("=")]),i("mi",[t._v("f")]),i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mi",{attrs:{mathvariant:"sans-serif"}},[t._v("X")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\mathsf{Y}=f(\\mathsf{X})")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathsf",staticStyle:{"margin-right":"0.025em"}},[t._v("Y")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[t._v("f")]),i("span",{staticClass:"mopen"},[t._v("(")]),i("span",{staticClass:"mord mathsf"},[t._v("X")]),i("span",{staticClass:"mclose"},[t._v(")")])])])]),t._v("和"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"sans-serif"}},[t._v("Z")]),i("mo",[t._v("=")]),i("mi",[t._v("g")]),i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mi",{attrs:{mathvariant:"sans-serif"}},[t._v("Y")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\mathsf{Z}=g(\\mathsf{Y})")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathsf"},[t._v("Z")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03588em"}},[t._v("g")]),i("span",{staticClass:"mopen"},[t._v("(")]),i("span",{staticClass:"mord mathsf",staticStyle:{"margin-right":"0.025em"}},[t._v("Y")]),i("span",{staticClass:"mclose"},[t._v(")")])])])]),t._v("，通过链式法则，我们有")]),t._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"sans-serif"}},[t._v("Z")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"sans-serif"}},[t._v("X")])],1)],1),i("mo",[t._v("=")]),i("mtext",[t._v("prod")]),i("mrow",[i("mo",{attrs:{fence:"true"}},[t._v("(")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"sans-serif"}},[t._v("Z")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"sans-serif"}},[t._v("Y")])],1)],1),i("mo",{attrs:{separator:"true"}},[t._v(",")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"sans-serif"}},[t._v("Y")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"sans-serif"}},[t._v("X")])],1)],1),i("mo",{attrs:{fence:"true"}},[t._v(")")])],1),i("mo",{attrs:{separator:"true"}},[t._v(",")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\frac{\\partial \\mathsf{Z}}{\\partial \\mathsf{X}} = \\text{prod}\\left(\\frac{\\partial \\mathsf{Z}}{\\partial \\mathsf{Y}}, \\frac{\\partial \\mathsf{Y}}{\\partial \\mathsf{X}}\\right),\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.05744em","vertical-align":"-0.686em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathsf"},[t._v("X")])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathsf"},[t._v("Z")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.40003em","vertical-align":"-0.95003em"}}),i("span",{staticClass:"mord text"},[i("span",{staticClass:"mord"},[t._v("prod")])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"minner"},[i("span",{staticClass:"mopen delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v("(")])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathsf",staticStyle:{"margin-right":"0.025em"}},[t._v("Y")])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathsf"},[t._v("Z")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mpunct"},[t._v(",")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathsf"},[t._v("X")])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathsf",staticStyle:{"margin-right":"0.025em"}},[t._v("Y")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mclose delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v(")")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mpunct"},[t._v(",")])])])])])]),t._v(" "),i("p",[t._v("其中"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mtext",[t._v("prod")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\text{prod}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),i("span",{staticClass:"mord text"},[i("span",{staticClass:"mord"},[t._v("prod")])])])])]),t._v("运算符将根据两个输入的形状，在必要的操作（如转置和互换输入位置）后对两个输入做乘法。")]),t._v(" "),i("p",[t._v("回顾一下本节中样例模型，它的参数是"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("1")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\boldsymbol{W}^{(1)}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.96401em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("1")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])])])]),t._v("和"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\boldsymbol{W}^{(2)}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.96401em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])])])]),t._v("，因此反向传播的目标是计算"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("1")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\partial J/\\partial \\boldsymbol{W}^{(1)}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.21401em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")]),i("span",{staticClass:"mord"},[t._v("/")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("1")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])])])]),t._v("和"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\partial J/\\partial \\boldsymbol{W}^{(2)}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.21401em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")]),i("span",{staticClass:"mord"},[t._v("/")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])])])]),t._v("。我们将应用链式法则依次计算各中间变量和参数的梯度，其计算次序与前向传播中相应中间变量的计算次序恰恰相反。首先，分别计算目标函数"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("J")]),i("mo",[t._v("=")]),i("mi",[t._v("L")]),i("mo",[t._v("+")]),i("mi",[t._v("s")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("J=L+s")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.76666em","vertical-align":"-0.08333em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("L")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[t._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("s")])])])]),t._v("有关损失项"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("L")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("L")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("L")])])])]),t._v("和正则项"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("s")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("s")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("s")])])])]),t._v("的梯度")]),t._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("L")])],1)],1),i("mo",[t._v("=")]),i("mn",[t._v("1")]),i("mo",{attrs:{separator:"true"}},[t._v(",")]),i("mspace",{attrs:{width:"1em"}}),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("s")])],1)],1),i("mo",[t._v("=")]),i("mn",[t._v("1.")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\frac{\\partial J}{\\partial L} = 1, \\quad \\frac{\\partial J}{\\partial s} = 1.\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.05744em","vertical-align":"-0.686em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal"},[t._v("L")])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.05744em","vertical-align":"-0.686em"}}),i("span",{staticClass:"mord"},[t._v("1")]),i("span",{staticClass:"mpunct"},[t._v(",")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"1em"}}),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal"},[t._v("s")])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.64444em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[t._v("1.")])])])])])]),t._v(" "),i("p",[t._v("其次，依据链式法则计算目标函数有关输出层变量的梯度"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("o")]),i("mo",[t._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[t._v("R")]),i("mi",[t._v("q")])],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\partial J/\\partial \\boldsymbol{o} \\in \\mathbb{R}^q")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")]),i("span",{staticClass:"mord"},[t._v("/")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("o")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.68889em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[t._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.664392em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03588em"}},[t._v("q")])])])])])])])])])])]),t._v("：")]),t._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("o")])],1)],1),i("mo",[t._v("=")]),i("mtext",[t._v("prod")]),i("mrow",[i("mo",{attrs:{fence:"true"}},[t._v("(")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("L")])],1)],1),i("mo",{attrs:{separator:"true"}},[t._v(",")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("L")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("o")])],1)],1),i("mo",{attrs:{fence:"true"}},[t._v(")")])],1),i("mo",[t._v("=")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("L")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("o")])],1)],1),i("mi",{attrs:{mathvariant:"normal"}},[t._v(".")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\frac{\\partial J}{\\partial \\boldsymbol{o}}\n= \\text{prod}\\left(\\frac{\\partial J}{\\partial L}, \\frac{\\partial L}{\\partial \\boldsymbol{o}}\\right)\n= \\frac{\\partial L}{\\partial \\boldsymbol{o}}.\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.05744em","vertical-align":"-0.686em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("o")])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.40003em","vertical-align":"-0.95003em"}}),i("span",{staticClass:"mord text"},[i("span",{staticClass:"mord"},[t._v("prod")])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"minner"},[i("span",{staticClass:"mopen delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v("(")])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal"},[t._v("L")])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mpunct"},[t._v(",")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("o")])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal"},[t._v("L")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mclose delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v(")")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.05744em","vertical-align":"-0.686em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("o")])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal"},[t._v("L")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mord"},[t._v(".")])])])])])]),t._v(" "),i("p",[t._v("接下来，计算正则项有关两个参数的梯度：")]),t._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("s")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("1")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1)],1),i("mo",[t._v("=")]),i("mi",[t._v("λ")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("1")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("mo",{attrs:{separator:"true"}},[t._v(",")]),i("mspace",{attrs:{width:"1em"}}),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("s")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1)],1),i("mo",[t._v("=")]),i("mi",[t._v("λ")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("mi",{attrs:{mathvariant:"normal"}},[t._v(".")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\frac{\\partial s}{\\partial \\boldsymbol{W}^{(1)}} = \\lambda \\boldsymbol{W}^{(1)},\\quad\\frac{\\partial s}{\\partial \\boldsymbol{W}^{(2)}} = \\lambda \\boldsymbol{W}^{(2)}.\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.22545em","vertical-align":"-0.85401em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.14599em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("1")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal"},[t._v("s")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.85401em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.22545em","vertical-align":"-0.85401em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("λ")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("1")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])]),i("span",{staticClass:"mpunct"},[t._v(",")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"1em"}}),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.14599em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal"},[t._v("s")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.85401em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.96401em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("λ")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])]),i("span",{staticClass:"mord"},[t._v(".")])])])])])]),t._v(" "),i("p",[t._v("现在，我们可以计算最靠近输出层的模型参数的梯度"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("mo",[t._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[t._v("R")]),i("mrow",[i("mi",[t._v("q")]),i("mo",[t._v("×")]),i("mi",[t._v("h")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\partial J/\\partial \\boldsymbol{W}^{(2)} \\in \\mathbb{R}^{q \\times h}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.21401em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")]),i("span",{staticClass:"mord"},[t._v("/")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8491079999999999em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[t._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.8491079999999999em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03588em"}},[t._v("q")]),i("span",{staticClass:"mbin mtight"},[t._v("×")]),i("span",{staticClass:"mord mathnormal mtight"},[t._v("h")])])])])])])])])])])])]),t._v("。依据链式法则，得到")]),t._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1)],1),i("mo",[t._v("=")]),i("mtext",[t._v("prod")]),i("mrow",[i("mo",{attrs:{fence:"true"}},[t._v("(")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("o")])],1)],1),i("mo",{attrs:{separator:"true"}},[t._v(",")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("o")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1)],1),i("mo",{attrs:{fence:"true"}},[t._v(")")])],1),i("mo",[t._v("+")]),i("mtext",[t._v("prod")]),i("mrow",[i("mo",{attrs:{fence:"true"}},[t._v("(")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("s")])],1)],1),i("mo",{attrs:{separator:"true"}},[t._v(",")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("s")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1)],1),i("mo",{attrs:{fence:"true"}},[t._v(")")])],1),i("mo",[t._v("=")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("o")])],1)],1),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("h")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("⊤")])],1),i("mo",[t._v("+")]),i("mi",[t._v("λ")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("mi",{attrs:{mathvariant:"normal"}},[t._v(".")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\frac{\\partial J}{\\partial \\boldsymbol{W}^{(2)}}\n= \\text{prod}\\left(\\frac{\\partial J}{\\partial \\boldsymbol{o}}, \\frac{\\partial \\boldsymbol{o}}{\\partial \\boldsymbol{W}^{(2)}}\\right) + \\text{prod}\\left(\\frac{\\partial J}{\\partial s}, \\frac{\\partial s}{\\partial \\boldsymbol{W}^{(2)}}\\right)\n= \\frac{\\partial J}{\\partial \\boldsymbol{o}} \\boldsymbol{h}^\\top + \\lambda \\boldsymbol{W}^{(2)}.\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.22545em","vertical-align":"-0.85401em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.14599em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.85401em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.40003em","vertical-align":"-0.95003em"}}),i("span",{staticClass:"mord text"},[i("span",{staticClass:"mord"},[t._v("prod")])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"minner"},[i("span",{staticClass:"mopen delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v("(")])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("o")])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mpunct"},[t._v(",")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.14599em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("o")])])])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.85401em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mclose delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v(")")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[t._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.40003em","vertical-align":"-0.95003em"}}),i("span",{staticClass:"mord text"},[i("span",{staticClass:"mord"},[t._v("prod")])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"minner"},[i("span",{staticClass:"mopen delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v("(")])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal"},[t._v("s")])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mpunct"},[t._v(",")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.14599em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal"},[t._v("s")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.85401em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mclose delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v(")")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.05744em","vertical-align":"-0.686em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("o")])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("h")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.9334479999999998em"}},[i("span",{staticStyle:{top:"-3.1473400000000002em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[t._v("⊤")])])])])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[t._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.96401em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("λ")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])]),i("span",{staticClass:"mord"},[t._v(".")])])])])])]),t._v(" "),i("p",[t._v("沿着输出层向隐藏层继续反向传播，隐藏层变量的梯度"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("h")]),i("mo",[t._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[t._v("R")]),i("mi",[t._v("h")])],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\partial J/\\partial \\boldsymbol{h} \\in \\mathbb{R}^h")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")]),i("span",{staticClass:"mord"},[t._v("/")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("h")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.849108em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[t._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.849108em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[t._v("h")])])])])])])])])])])]),t._v("可以这样计算：")]),t._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("h")])],1)],1),i("mo",[t._v("=")]),i("mtext",[t._v("prod")]),i("mrow",[i("mo",{attrs:{fence:"true"}},[t._v("(")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("o")])],1)],1),i("mo",{attrs:{separator:"true"}},[t._v(",")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("o")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("h")])],1)],1),i("mo",{attrs:{fence:"true"}},[t._v(")")])],1),i("mo",[t._v("=")]),i("msup",[i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("mi",{attrs:{mathvariant:"normal"}},[t._v("⊤")])],1),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("o")])],1)],1),i("mi",{attrs:{mathvariant:"normal"}},[t._v(".")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\frac{\\partial J}{\\partial \\boldsymbol{h}}\n= \\text{prod}\\left(\\frac{\\partial J}{\\partial \\boldsymbol{o}}, \\frac{\\partial \\boldsymbol{o}}{\\partial \\boldsymbol{h}}\\right)\n= {\\boldsymbol{W}^{(2)}}^\\top \\frac{\\partial J}{\\partial \\boldsymbol{o}}.\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.05744em","vertical-align":"-0.686em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("h")])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.40003em","vertical-align":"-0.95003em"}}),i("span",{staticClass:"mord text"},[i("span",{staticClass:"mord"},[t._v("prod")])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"minner"},[i("span",{staticClass:"mopen delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v("(")])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("o")])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mpunct"},[t._v(",")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("h")])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("o")])])])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mclose delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v(")")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.05744em","vertical-align":"-0.686em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.203018em"}},[i("span",{staticStyle:{top:"-3.41691em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[t._v("⊤")])])])])])])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("o")])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mord"},[t._v(".")])])])])])]),t._v(" "),i("p",[t._v("由于激活函数"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("ϕ")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\phi")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("ϕ")])])])]),t._v("是按元素运算的，中间变量"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("z")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\boldsymbol{z}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.44444em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.04213em"}},[t._v("z")])])])])])]),t._v("的梯度"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("z")]),i("mo",[t._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[t._v("R")]),i("mi",[t._v("h")])],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\partial J/\\partial \\boldsymbol{z} \\in \\mathbb{R}^h")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")]),i("span",{staticClass:"mord"},[t._v("/")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.04213em"}},[t._v("z")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.849108em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[t._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.849108em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[t._v("h")])])])])])])])])])])]),t._v("的计算需要使用按元素乘法符"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mo",[t._v("⊙")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\odot")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.66666em","vertical-align":"-0.08333em"}}),i("span",{staticClass:"mord"},[t._v("⊙")])])])]),t._v("：")]),t._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("z")])],1)],1),i("mo",[t._v("=")]),i("mtext",[t._v("prod")]),i("mrow",[i("mo",{attrs:{fence:"true"}},[t._v("(")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("h")])],1)],1),i("mo",{attrs:{separator:"true"}},[t._v(",")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("h")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("z")])],1)],1),i("mo",{attrs:{fence:"true"}},[t._v(")")])],1),i("mo",[t._v("=")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("h")])],1)],1),i("mo",[t._v("⊙")]),i("msup",[i("mi",[t._v("ϕ")]),i("mo",{attrs:{mathvariant:"normal",lspace:"0em",rspace:"0em"}},[t._v("′")])],1),i("mrow",[i("mo",{attrs:{fence:"true"}},[t._v("(")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("z")]),i("mo",{attrs:{fence:"true"}},[t._v(")")])],1),i("mi",{attrs:{mathvariant:"normal"}},[t._v(".")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\frac{\\partial J}{\\partial \\boldsymbol{z}}\n= \\text{prod}\\left(\\frac{\\partial J}{\\partial \\boldsymbol{h}}, \\frac{\\partial \\boldsymbol{h}}{\\partial \\boldsymbol{z}}\\right)\n= \\frac{\\partial J}{\\partial \\boldsymbol{h}} \\odot \\phi'\\left(\\boldsymbol{z}\\right).\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.05744em","vertical-align":"-0.686em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.04213em"}},[t._v("z")])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.40003em","vertical-align":"-0.95003em"}}),i("span",{staticClass:"mord text"},[i("span",{staticClass:"mord"},[t._v("prod")])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"minner"},[i("span",{staticClass:"mopen delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v("(")])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("h")])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mpunct"},[t._v(",")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.04213em"}},[t._v("z")])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("h")])])])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mclose delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v(")")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.05744em","vertical-align":"-0.686em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("h")])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[t._v("⊙")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.051892em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathnormal"},[t._v("ϕ")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.801892em"}},[i("span",{staticStyle:{top:"-3.113em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mord mtight"},[t._v("′")])])])])])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"minner"},[i("span",{staticClass:"mopen delimcenter",staticStyle:{top:"0em"}},[t._v("(")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.04213em"}},[t._v("z")])])]),i("span",{staticClass:"mclose delimcenter",staticStyle:{top:"0em"}},[t._v(")")])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mord"},[t._v(".")])])])])])]),t._v(" "),i("p",[t._v("最终，我们可以得到最靠近输入层的模型参数的梯度"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("1")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("mo",[t._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[t._v("R")]),i("mrow",[i("mi",[t._v("h")]),i("mo",[t._v("×")]),i("mi",[t._v("d")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\partial J/\\partial \\boldsymbol{W}^{(1)} \\in \\mathbb{R}^{h \\times d}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.21401em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")]),i("span",{staticClass:"mord"},[t._v("/")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("1")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8491079999999999em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[t._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.8491079999999999em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[t._v("h")]),i("span",{staticClass:"mbin mtight"},[t._v("×")]),i("span",{staticClass:"mord mathnormal mtight"},[t._v("d")])])])])])])])])])])])]),t._v("。依据链式法则，得到")]),t._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("1")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1)],1),i("mo",[t._v("=")]),i("mtext",[t._v("prod")]),i("mrow",[i("mo",{attrs:{fence:"true"}},[t._v("(")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("z")])],1)],1),i("mo",{attrs:{separator:"true"}},[t._v(",")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("z")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("1")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1)],1),i("mo",{attrs:{fence:"true"}},[t._v(")")])],1),i("mo",[t._v("+")]),i("mtext",[t._v("prod")]),i("mrow",[i("mo",{attrs:{fence:"true"}},[t._v("(")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("s")])],1)],1),i("mo",{attrs:{separator:"true"}},[t._v(",")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("s")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("1")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1)],1),i("mo",{attrs:{fence:"true"}},[t._v(")")])],1),i("mo",[t._v("=")]),i("mfrac",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")])],1),i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("z")])],1)],1),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("x")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("⊤")])],1),i("mo",[t._v("+")]),i("mi",[t._v("λ")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("1")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("mi",{attrs:{mathvariant:"normal"}},[t._v(".")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\frac{\\partial J}{\\partial \\boldsymbol{W}^{(1)}}\n= \\text{prod}\\left(\\frac{\\partial J}{\\partial \\boldsymbol{z}}, \\frac{\\partial \\boldsymbol{z}}{\\partial \\boldsymbol{W}^{(1)}}\\right) + \\text{prod}\\left(\\frac{\\partial J}{\\partial s}, \\frac{\\partial s}{\\partial \\boldsymbol{W}^{(1)}}\\right)\n= \\frac{\\partial J}{\\partial \\boldsymbol{z}} \\boldsymbol{x}^\\top + \\lambda \\boldsymbol{W}^{(1)}.\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.22545em","vertical-align":"-0.85401em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.14599em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("1")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.85401em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.40003em","vertical-align":"-0.95003em"}}),i("span",{staticClass:"mord text"},[i("span",{staticClass:"mord"},[t._v("prod")])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"minner"},[i("span",{staticClass:"mopen delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v("(")])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.04213em"}},[t._v("z")])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mpunct"},[t._v(",")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.14599em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("1")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.04213em"}},[t._v("z")])])])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.85401em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mclose delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v(")")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[t._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.40003em","vertical-align":"-0.95003em"}}),i("span",{staticClass:"mord text"},[i("span",{staticClass:"mord"},[t._v("prod")])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"minner"},[i("span",{staticClass:"mopen delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v("(")])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal"},[t._v("s")])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mpunct"},[t._v(",")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.14599em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("1")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal"},[t._v("s")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.85401em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mclose delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size3"},[t._v(")")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.05744em","vertical-align":"-0.686em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.37144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.04213em"}},[t._v("z")])])])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("x")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.8991079999999999em"}},[i("span",{staticStyle:{top:"-3.113em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[t._v("⊤")])])])])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[t._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.96401em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("λ")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("1")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])]),i("span",{staticClass:"mord"},[t._v(".")])])])])])]),t._v(" "),i("h2",{attrs:{id:"训练深度学习模型"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#训练深度学习模型"}},[t._v("#")]),t._v(" 训练深度学习模型")]),t._v(" "),i("p",[t._v("在训练深度学习模型时，正向传播和反向传播之间相互依赖。下面我们仍然以本节中的样例模型分别阐述它们之间的依赖关系。")]),t._v(" "),i("p",[t._v("一方面，正向传播的计算可能依赖于模型参数的当前值，而这些模型参数是在反向传播的梯度计算后通过优化算法迭代的。例如，计算正则化项"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[t._v("s")]),i("mo",[t._v("=")]),i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mi",[t._v("λ")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")]),i("mrow",[i("mo",{attrs:{fence:"true"}},[t._v("(")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("∥")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("1")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("msubsup",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∥")]),i("mi",[t._v("F")]),i("mn",[t._v("2")])],1),i("mo",[t._v("+")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("∥")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("msubsup",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∥")]),i("mi",[t._v("F")]),i("mn",[t._v("2")])],1),i("mo",{attrs:{fence:"true"}},[t._v(")")])],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("s = (\\lambda/2) \\left(\\|\\boldsymbol{W}^{(1)}\\|_F^2 + \\|\\boldsymbol{W}^{(2)}\\|_F^2\\right)")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("s")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.80002em","vertical-align":"-0.65002em"}}),i("span",{staticClass:"mopen"},[t._v("(")]),i("span",{staticClass:"mord mathnormal"},[t._v("λ")]),i("span",{staticClass:"mord"},[t._v("/2")]),i("span",{staticClass:"mclose"},[t._v(")")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"minner"},[i("span",{staticClass:"mopen delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size2"},[t._v("(")])]),i("span",{staticClass:"mord"},[t._v("∥")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("1")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[t._v("∥")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.8141079999999999em"}},[i("span",{staticStyle:{top:"-2.424669em","margin-left":"0em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.13889em"}},[t._v("F")])])]),i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[t._v("2")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.275331em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[t._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mord"},[t._v("∥")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[t._v("∥")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.8141079999999999em"}},[i("span",{staticStyle:{top:"-2.424669em","margin-left":"0em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.13889em"}},[t._v("F")])])]),i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[t._v("2")])])])]),i("span",{staticClass:"vlist-s"},[t._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.275331em"}},[i("span")])])])])]),i("span",{staticClass:"mclose delimcenter",staticStyle:{top:"0em"}},[i("span",{staticClass:"delimsizing size2"},[t._v(")")])])])])])]),t._v("依赖模型参数"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("1")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\boldsymbol{W}^{(1)}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.96401em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("1")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])])])]),t._v("和"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\boldsymbol{W}^{(2)}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.96401em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])])])]),t._v("的当前值，而这些当前值是优化算法最近一次根据反向传播算出梯度后迭代得到的。")]),t._v(" "),i("p",[t._v("另一方面，反向传播的梯度计算可能依赖于各变量的当前值，而这些变量的当前值是通过正向传播计算得到的。举例来说，参数梯度"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1),i("mo",[t._v("=")]),i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",[t._v("J")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("/")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("∂")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("o")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("h")]),i("mi",{attrs:{mathvariant:"normal"}},[t._v("⊤")])],1),i("mo",[t._v("+")]),i("mi",[t._v("λ")]),i("msup",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("W")]),i("mrow",[i("mo",{attrs:{stretchy:"false"}},[t._v("(")]),i("mn",[t._v("2")]),i("mo",{attrs:{stretchy:"false"}},[t._v(")")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\partial J/\\partial \\boldsymbol{W}^{(2)} = (\\partial J / \\partial \\boldsymbol{o}) \\boldsymbol{h}^\\top + \\lambda \\boldsymbol{W}^{(2)}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.21401em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")]),i("span",{staticClass:"mord"},[t._v("/")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[t._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.1834479999999998em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mopen"},[t._v("(")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.09618em"}},[t._v("J")]),i("span",{staticClass:"mord"},[t._v("/")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.05556em"}},[t._v("∂")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("o")])])]),i("span",{staticClass:"mclose"},[t._v(")")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("h")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.9334479999999998em"}},[i("span",{staticStyle:{top:"-3.1473400000000002em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[t._v("⊤")])])])])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[t._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.96401em","vertical-align":"0em"}}),i("span",{staticClass:"mord mathnormal"},[t._v("λ")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[t._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.96401em"}},[i("span",{staticStyle:{top:"-3.13901em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mopen mtight"},[t._v("(")]),i("span",{staticClass:"mord mtight"},[t._v("2")]),i("span",{staticClass:"mclose mtight"},[t._v(")")])])])])])])])])])])])]),t._v("的计算需要依赖隐藏层变量的当前值"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"bold-italic"}},[t._v("h")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\boldsymbol{h}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[t._v("h")])])])])])]),t._v("。这个当前值是通过从输入层到输出层的正向传播计算并存储得到的。")]),t._v(" "),i("p",[t._v("因此，在模型参数初始化完成后，我们交替地进行正向传播和反向传播，并根据反向传播计算的梯度迭代模型参数。既然我们在反向传播中使用了正向传播中计算得到的中间变量来避免重复计算，那么这个复用也导致正向传播结束后不能立即释放中间变量内存。这也是训练要比预测占用更多内存的一个重要原因。另外需要指出的是，这些中间变量的个数大体上与网络层数线性相关，每个变量的大小跟批量大小和输入个数也是线性相关的，它们是导致较深的神经网络使用较大批量训练时更容易超内存的主要原因。")]),t._v(" "),i("h2",{attrs:{id:"小结"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[t._v("#")]),t._v(" 小结")]),t._v(" "),i("ul",[i("li",[t._v("正向传播沿着从输入层到输出层的顺序，依次计算并存储神经网络的中间变量。")]),t._v(" "),i("li",[t._v("反向传播沿着从输出层到输入层的顺序，依次计算并存储神经网络中间变量和参数的梯度。")]),t._v(" "),i("li",[t._v("在训练深度学习模型时，正向传播和反向传播相互依赖。")])])])}),[],!1,null,null,null);s.default=l.exports}}]);