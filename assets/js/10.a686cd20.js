(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{401:function(s,t,a){s.exports=a.p+"assets/img/mlp.23dbd8c2.svg"},402:function(s,t,a){s.exports=a.p+"assets/img/myplot.4c2eee81.png"},403:function(s,t,a){s.exports=a.p+"assets/img/relugrad.611dbe46.png"},404:function(s,t,a){s.exports=a.p+"assets/img/sigmoid.77e2a956.png"},405:function(s,t,a){s.exports=a.p+"assets/img/sigmoidgrad.18e45b9b.png"},406:function(s,t,a){s.exports=a.p+"assets/img/tanh.da9f12d4.png"},407:function(s,t,a){s.exports=a.p+"assets/img/tahngard.bd69d85c.png"},539:function(s,t,a){"use strict";a.r(t);var i=a(46),n=Object(i.a)({},(function(){var s=this,t=s.$createElement,i=s._self._c||t;return i("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[i("h1",{attrs:{id:"多层感知机"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#多层感知机"}},[s._v("#")]),s._v(" 多层感知机")]),s._v(" "),i("p",[s._v("我们已经介绍了包括"),i("RouterLink",{attrs:{to:"/ch1p1/linear-regression.html"}},[s._v("线性回归")]),s._v("和"),i("RouterLink",{attrs:{to:"/ch1p1/softmax-regression.html"}},[s._v("softmax回归")]),s._v("在内的单层神经网络。然而深度学习主要关注多层模型。在本节中，我们将以多层感知机（multilayer perceptron，MLP）为例，介绍多层神经网络的概念。")],1),s._v(" "),i("h2",{attrs:{id:"隐藏层"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#隐藏层"}},[s._v("#")]),s._v(" 隐藏层")]),s._v(" "),i("p",[s._v("多层感知机在单层神经网络的基础上引入了一到多个隐藏层（hidden layer）。隐藏层位于输入层和输出层之间。下图展示了一个多层感知机的神经网络图。它带有隐藏层的多层感知机。它含有一个隐藏层，该层中有5个隐藏单元。")]),s._v(" "),i("p",[i("img",{attrs:{src:a(401),alt:""}})]),s._v(" "),i("p",[s._v("在上图所示的多层感知机中，输入和输出个数分别为4和3，中间的隐藏层中包含了5个隐藏单元（hidden unit）。由于输入层不涉及计算，上图中的多层感知机的层数为2。可见，隐藏层中的神经元和输入层中各个输入完全连接，输出层中的神经元和隐藏层中的各个神经元也完全连接。因此，多层感知机中的隐藏层和输出层都是全连接层。")]),s._v(" "),i("p",[s._v("具体来说，给定一个小批量样本"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("X")]),i("mo",[s._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[s._v("R")]),i("mrow",[i("mi",[s._v("n")]),i("mo",[s._v("×")]),i("mi",[s._v("d")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\boldsymbol{X} \\in \\mathbb{R}^{n \\times d}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.72521em","vertical-align":"-0.0391em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.07778em"}},[s._v("X")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8491079999999999em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[s._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.8491079999999999em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("n")]),i("span",{staticClass:"mbin mtight"},[s._v("×")]),i("span",{staticClass:"mord mathnormal mtight"},[s._v("d")])])])])])])])])])])])]),s._v("，其批量大小为n，输入个数为d。假设多层感知机只有一个隐藏层，其中隐藏单元个数为h。记隐藏层的输出（也称为隐藏层变量或隐藏变量）为"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("H")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\boldsymbol{H}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.68611em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.08229em"}},[s._v("H")])])])])])]),s._v("，有"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("H")]),i("mo",[s._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[s._v("R")]),i("mrow",[i("mi",[s._v("n")]),i("mo",[s._v("×")]),i("mi",[s._v("h")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\boldsymbol{H} \\in \\mathbb{R}^{n \\times h}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.72521em","vertical-align":"-0.0391em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.08229em"}},[s._v("H")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8491079999999999em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[s._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.8491079999999999em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("n")]),i("span",{staticClass:"mbin mtight"},[s._v("×")]),i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")])])])])])])])])])])])]),s._v("。因为隐藏层和输出层均是全连接层，可以设隐藏层的权重参数和偏差参数分别为"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("W")]),i("mi",[s._v("h")])],1),i("mo",[s._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[s._v("R")]),i("mrow",[i("mi",[s._v("d")]),i("mo",[s._v("×")]),i("mi",[s._v("h")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\boldsymbol{W}_h \\in \\mathbb{R}^{d \\times h}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.83611em","vertical-align":"-0.15em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[s._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8491079999999999em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[s._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.8491079999999999em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("d")]),i("span",{staticClass:"mbin mtight"},[s._v("×")]),i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")])])])])])])])])])])])]),s._v("和 "),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("b")]),i("mi",[s._v("h")])],1),i("mo",[s._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[s._v("R")]),i("mrow",[i("mn",[s._v("1")]),i("mo",[s._v("×")]),i("mi",[s._v("h")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\boldsymbol{b}_h \\in \\mathbb{R}^{1 \\times h}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.84444em","vertical-align":"-0.15em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[s._v("b")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8491079999999999em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[s._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.8491079999999999em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mord mtight"},[s._v("1")]),i("span",{staticClass:"mbin mtight"},[s._v("×")]),i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")])])])])])])])])])])])]),s._v("，输出层的权重和偏差参数分别为"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("W")]),i("mi",[s._v("o")])],1),i("mo",[s._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[s._v("R")]),i("mrow",[i("mi",[s._v("h")]),i("mo",[s._v("×")]),i("mi",[s._v("q")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\boldsymbol{W}_o \\in \\mathbb{R}^{h \\times q}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.83611em","vertical-align":"-0.15em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[s._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8491079999999999em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[s._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.8491079999999999em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")]),i("span",{staticClass:"mbin mtight"},[s._v("×")]),i("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03588em"}},[s._v("q")])])])])])])])])])])])]),s._v("和"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("b")]),i("mi",[s._v("o")])],1),i("mo",[s._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[s._v("R")]),i("mrow",[i("mn",[s._v("1")]),i("mo",[s._v("×")]),i("mi",[s._v("q")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\boldsymbol{b}_o \\in \\mathbb{R}^{1 \\times q}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.84444em","vertical-align":"-0.15em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[s._v("b")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8141079999999999em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[s._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.8141079999999999em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mord mtight"},[s._v("1")]),i("span",{staticClass:"mbin mtight"},[s._v("×")]),i("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03588em"}},[s._v("q")])])])])])])])])])])])]),s._v("。")]),s._v(" "),i("p",[s._v("我们先来看一种含单隐藏层的多层感知机的设计。其输出"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("O")]),i("mo",[s._v("∈")]),i("msup",[i("mi",{attrs:{mathvariant:"double-struck"}},[s._v("R")]),i("mrow",[i("mi",[s._v("n")]),i("mo",[s._v("×")]),i("mi",[s._v("q")])],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\boldsymbol{O} \\in \\mathbb{R}^{n \\times q}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.72521em","vertical-align":"-0.0391em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.03194em"}},[s._v("O")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("∈")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.771331em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord mathbb"},[s._v("R")]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.771331em"}},[i("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("n")]),i("span",{staticClass:"mbin mtight"},[s._v("×")]),i("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03588em"}},[s._v("q")])])])])])])])])])])])]),s._v("的计算为")]),s._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mtable",{attrs:{rowspacing:"0.2500em",columnalign:"right",columnspacing:""}},[i("mtr",[i("mtd",[i("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[i("mtable",{attrs:{rowspacing:"0.2500em",columnalign:"right left",columnspacing:"0em"}},[i("mtr",[i("mtd",[i("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("H")])],1)],1),i("mtd",[i("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[i("mrow",[i("mrow"),i("mo",[s._v("=")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("X")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("W")]),i("mi",[s._v("h")])],1),i("mo",[s._v("+")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("b")]),i("mi",[s._v("h")])],1),i("mo",{attrs:{separator:"true"}},[s._v(",")])],1)],1)],1)],1),i("mtr",[i("mtd",[i("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("O")])],1)],1),i("mtd",[i("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[i("mrow",[i("mrow"),i("mo",[s._v("=")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("H")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("W")]),i("mi",[s._v("o")])],1),i("mo",[s._v("+")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("b")]),i("mi",[s._v("o")])],1),i("mo",{attrs:{separator:"true"}},[s._v(",")])],1)],1)],1)],1)],1)],1)],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\begin{split}\\begin{aligned} \\boldsymbol{H} &= \\boldsymbol{X} \\boldsymbol{W}_h + \\boldsymbol{b}_h,\\\\ \\boldsymbol{O} &= \\boldsymbol{H} \\boldsymbol{W}_o + \\boldsymbol{b}_o, \\end{aligned}\\end{split}\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"3.3000000000000007em","vertical-align":"-1.4000000000000001em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mtable"},[i("span",{staticClass:"col-align-r"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.9000000000000006em"}},[i("span",{staticStyle:{top:"-3.9em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3.75em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mtable"},[i("span",{staticClass:"col-align-r"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.7500000000000002em"}},[i("span",{staticStyle:{top:"-3.91em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.08229em"}},[s._v("H")])])])])]),i("span",{staticStyle:{top:"-2.41em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.03194em"}},[s._v("O")])])])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.2500000000000002em"}},[i("span")])])])]),i("span",{staticClass:"col-align-l"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.7500000000000002em"}},[i("span",{staticStyle:{top:"-3.91em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"}),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.07778em"}},[s._v("X")])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[s._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[s._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[s._v("b")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mpunct"},[s._v(",")])])]),i("span",{staticStyle:{top:"-2.41em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"}),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.08229em"}},[s._v("H")])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[s._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[s._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[s._v("b")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mpunct"},[s._v(",")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.2500000000000002em"}},[i("span")])])])])])])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.4000000000000001em"}},[i("span")])])])])])])])])])])]),s._v(" "),i("p",[s._v("也就是将隐藏层的输出直接作为输出层的输入。如果将以上两个式子联立起来，可以得到")]),s._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("O")]),i("mo",[s._v("=")]),i("mo",{attrs:{stretchy:"false"}},[s._v("(")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("X")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("W")]),i("mi",[s._v("h")])],1),i("mo",[s._v("+")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("b")]),i("mi",[s._v("h")])],1),i("mo",{attrs:{stretchy:"false"}},[s._v(")")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("W")]),i("mi",[s._v("o")])],1),i("mo",[s._v("+")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("b")]),i("mi",[s._v("o")])],1),i("mo",[s._v("=")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("X")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("W")]),i("mi",[s._v("h")])],1),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("W")]),i("mi",[s._v("o")])],1),i("mo",[s._v("+")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("b")]),i("mi",[s._v("h")])],1),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("W")]),i("mi",[s._v("o")])],1),i("mo",[s._v("+")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("b")]),i("mi",[s._v("o")])],1),i("mi",{attrs:{mathvariant:"normal"}},[s._v(".")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\boldsymbol{O} = (\\boldsymbol{X} \\boldsymbol{W}_h + \\boldsymbol{b}_h)\\boldsymbol{W}_o + \\boldsymbol{b}_o = \\boldsymbol{X} \\boldsymbol{W}_h\\boldsymbol{W}_o + \\boldsymbol{b}_h \\boldsymbol{W}_o + \\boldsymbol{b}_o.\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.68611em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.03194em"}},[s._v("O")])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.07778em"}},[s._v("X")])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[s._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[s._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[s._v("b")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mclose"},[s._v(")")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[s._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[s._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.84444em","vertical-align":"-0.15em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[s._v("b")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.83611em","vertical-align":"-0.15em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.07778em"}},[s._v("X")])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[s._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[s._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[s._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.84444em","vertical-align":"-0.15em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[s._v("b")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[s._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[s._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.84444em","vertical-align":"-0.15em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[s._v("b")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mord"},[s._v(".")])])])])])]),s._v(" "),i("p",[s._v("从联立后的式子可以看出，虽然神经网络引入了隐藏层，却依然等价于一个单层神经网络：其中输出层权重参数为"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("W")]),i("mi",[s._v("h")])],1),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("W")]),i("mi",[s._v("o")])],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\boldsymbol{W}_h\\boldsymbol{W}_o")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.83611em","vertical-align":"-0.15em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[s._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[s._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])])])])]),s._v("，偏差参数为"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("b")]),i("mi",[s._v("h")])],1),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("W")]),i("mi",[s._v("o")])],1),i("mo",[s._v("+")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("b")]),i("mi",[s._v("o")])],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\boldsymbol{b}_h \\boldsymbol{W}_o + \\boldsymbol{b}_o")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.84444em","vertical-align":"-0.15em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[s._v("b")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[s._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[s._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.84444em","vertical-align":"-0.15em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[s._v("b")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])])])])]),s._v("。不难发现，即便再添加更多的隐藏层，以上设计依然只能与仅含输出层的单层神经网络等价。")]),s._v(" "),i("h2",{attrs:{id:"激活函数"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#激活函数"}},[s._v("#")]),s._v(" 激活函数")]),s._v(" "),i("p",[s._v("上述问题的根源在于全连接层只是对数据做仿射变换（affine transformation），而多个仿射变换的叠加仍然是一个仿射变换。解决问题的一个方法是引入非线性变换，例如对隐藏变量使用按元素运算的非线性函数进行变换，然后再作为下一个全连接层的输入。这个非线性函数被称为激活函数（activation function）。下面我们介绍几个常用的激活函数。")]),s._v(" "),i("h3",{attrs:{id:"relu函数"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#relu函数"}},[s._v("#")]),s._v(" ReLU函数")]),s._v(" "),i("p",[s._v("ReLU（rectified linear unit）函数提供了一个很简单的非线性变换。给定元素x，该函数定义为$\\text{ReLU}(x) = \\max(x, 0) $")]),s._v(" "),i("p",[s._v("可以看出，ReLU函数只保留正数元素，并将负数元素清零。为了直观地观察这一非线性变换，我们先定义一个绘图函数"),i("code",[s._v("xyplot")]),s._v("。")]),s._v(" "),i("div",{staticClass:"language-python line-numbers-mode"},[i("pre",{pre:!0,attrs:{class:"language-python"}},[i("code",[i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" tensorflow "),i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" tf\n"),i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" matplotlib"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pyplot "),i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" plt\n\nx "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("constant"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("range")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),i("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),i("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),i("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nout "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("nn"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("relu"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xlabel"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x"')]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ylabel"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token string"}},[s._v('"reLU x"')]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plot"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" out"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("show"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),i("div",{staticClass:"line-numbers-wrapper"},[i("span",{staticClass:"line-number"},[s._v("1")]),i("br"),i("span",{staticClass:"line-number"},[s._v("2")]),i("br"),i("span",{staticClass:"line-number"},[s._v("3")]),i("br"),i("span",{staticClass:"line-number"},[s._v("4")]),i("br"),i("span",{staticClass:"line-number"},[s._v("5")]),i("br"),i("span",{staticClass:"line-number"},[s._v("6")]),i("br"),i("span",{staticClass:"line-number"},[s._v("7")]),i("br"),i("span",{staticClass:"line-number"},[s._v("8")]),i("br"),i("span",{staticClass:"line-number"},[s._v("9")]),i("br")])]),i("p",[s._v("下图是会上面这段代码绘制出的图形")]),s._v(" "),i("p",[i("img",{attrs:{src:a(402),alt:""}})]),s._v(" "),i("p",[s._v("可以看出，该函数定义为$\\text{ReLU}(x) = \\max(x, 0) "),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mtext",[s._v("，在")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("，在")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),i("span",{staticClass:"mord cjk_fallback"},[s._v("，在")])])])]),s._v("x>0"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mtext",[s._v("处函数值为")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("处函数值为")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),i("span",{staticClass:"mord cjk_fallback"},[s._v("处函数值为")])])])]),s._v("x"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mtext",[s._v("本身。因此在")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("本身。因此在")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),i("span",{staticClass:"mord cjk_fallback"},[s._v("本身。因此在")])])])]),s._v("x>0$处的梯度应该是1。")]),s._v(" "),i("p",[s._v("接下来我们打出它的梯度：")]),s._v(" "),i("div",{staticClass:"language-python line-numbers-mode"},[i("pre",{pre:!0,attrs:{class:"language-python"}},[i("code",[s._v("x "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Variable"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cast"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dtype"),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("float32"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GradientTape"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" tape"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    y "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("nn"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("relu"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xlabel"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x"')]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ylabel"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token string"}},[s._v('"(reLU x)\\\'"')]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ngrad "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tape"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gradient"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("y"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plot"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("numpy"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" grad"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("show"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),i("div",{staticClass:"line-numbers-wrapper"},[i("span",{staticClass:"line-number"},[s._v("1")]),i("br"),i("span",{staticClass:"line-number"},[s._v("2")]),i("br"),i("span",{staticClass:"line-number"},[s._v("3")]),i("br"),i("span",{staticClass:"line-number"},[s._v("4")]),i("br"),i("span",{staticClass:"line-number"},[s._v("5")]),i("br"),i("span",{staticClass:"line-number"},[s._v("6")]),i("br"),i("span",{staticClass:"line-number"},[s._v("7")]),i("br"),i("span",{staticClass:"line-number"},[s._v("8")]),i("br")])]),i("p",[s._v("下图是代码打印出的图形：")]),s._v(" "),i("p",[i("img",{attrs:{src:a(403),alt:""}})]),s._v(" "),i("h3",{attrs:{id:"sigmoid函数"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#sigmoid函数"}},[s._v("#")]),s._v(" Sigmoid函数")]),s._v(" "),i("p",[s._v("sigmoid函数可以将元素的值变换到0和1之间：")]),s._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mtext",[s._v("sigmoid")]),i("mo",{attrs:{stretchy:"false"}},[s._v("(")]),i("mi",[s._v("x")]),i("mo",{attrs:{stretchy:"false"}},[s._v(")")]),i("mo",[s._v("=")]),i("mfrac",[i("mn",[s._v("1")]),i("mrow",[i("mn",[s._v("1")]),i("mo",[s._v("+")]),i("mi",[s._v("exp")]),i("mo",[s._v("⁡")]),i("mo",{attrs:{stretchy:"false"}},[s._v("(")]),i("mo",[s._v("−")]),i("mi",[s._v("x")]),i("mo",{attrs:{stretchy:"false"}},[s._v(")")])],1)],1),i("mi",{attrs:{mathvariant:"normal"}},[s._v(".")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\text{sigmoid}(x) = \\frac{1}{1 + \\exp(-x)}.\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord text"},[i("span",{staticClass:"mord"},[s._v("sigmoid")])]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord mathnormal"},[s._v("x")]),i("span",{staticClass:"mclose"},[s._v(")")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.25744em","vertical-align":"-0.936em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.32144em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[s._v("1")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[s._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mop"},[s._v("exp")]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord"},[s._v("−")]),i("span",{staticClass:"mord mathnormal"},[s._v("x")]),i("span",{staticClass:"mclose"},[s._v(")")])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[s._v("1")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.936em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mord"},[s._v(".")])])])])])]),s._v(" "),i("p",[s._v("sigmoid函数在早期的神经网络中较为普遍，但它目前逐渐被更简单的ReLU函数取代。在后面“循环神经网络”一章中我们会介绍如何利用它值域在0到1之间这一特性来控制信息在神经网络中的流动。下面绘制了sigmoid函数。当输入接近0时，sigmoid函数接近线性变换。")]),s._v(" "),i("p",[s._v("我们绘制sigmoid的函数图像：")]),s._v(" "),i("div",{staticClass:"language-python line-numbers-mode"},[i("pre",{pre:!0,attrs:{class:"language-python"}},[i("code",[i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" tensorflow "),i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" tf\n"),i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" matplotlib"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pyplot "),i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" plt\n\nx "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("constant"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("range")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),i("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),i("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),i("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nx "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cast"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("dtype"),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("float32"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nout "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("nn"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sigmoid"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xlabel"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x"')]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ylabel"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token string"}},[s._v('"reLU x"')]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plot"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" out"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("show"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),i("div",{staticClass:"line-numbers-wrapper"},[i("span",{staticClass:"line-number"},[s._v("1")]),i("br"),i("span",{staticClass:"line-number"},[s._v("2")]),i("br"),i("span",{staticClass:"line-number"},[s._v("3")]),i("br"),i("span",{staticClass:"line-number"},[s._v("4")]),i("br"),i("span",{staticClass:"line-number"},[s._v("5")]),i("br"),i("span",{staticClass:"line-number"},[s._v("6")]),i("br"),i("span",{staticClass:"line-number"},[s._v("7")]),i("br"),i("span",{staticClass:"line-number"},[s._v("8")]),i("br"),i("span",{staticClass:"line-number"},[s._v("9")]),i("br"),i("span",{staticClass:"line-number"},[s._v("10")]),i("br")])]),i("p",[s._v("这段代码绘制的图像如下图：")]),s._v(" "),i("p",[i("img",{attrs:{src:a(404),alt:""}})]),s._v(" "),i("p",[s._v("依据链式法则，sigmoid函数的导数为：")]),s._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("msup",[i("mtext",[s._v("sigmoid")]),i("mo",{attrs:{mathvariant:"normal",lspace:"0em",rspace:"0em"}},[s._v("′")])],1),i("mo",{attrs:{stretchy:"false"}},[s._v("(")]),i("mi",[s._v("x")]),i("mo",{attrs:{stretchy:"false"}},[s._v(")")]),i("mo",[s._v("=")]),i("mtext",[s._v("sigmoid")]),i("mo",{attrs:{stretchy:"false"}},[s._v("(")]),i("mi",[s._v("x")]),i("mo",{attrs:{stretchy:"false"}},[s._v(")")]),i("mrow",[i("mo",{attrs:{fence:"true"}},[s._v("(")]),i("mn",[s._v("1")]),i("mo",[s._v("−")]),i("mtext",[s._v("sigmoid")]),i("mo",{attrs:{stretchy:"false"}},[s._v("(")]),i("mi",[s._v("x")]),i("mo",{attrs:{stretchy:"false"}},[s._v(")")]),i("mo",{attrs:{fence:"true"}},[s._v(")")])],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\text{sigmoid}'(x) = \\text{sigmoid}(x)\\left(1-\\text{sigmoid}(x)\\right)\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.0862319999999999em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord text"},[i("span",{staticClass:"mord"},[s._v("sigmoid")])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.836232em"}},[i("span",{staticStyle:{top:"-3.1473400000000002em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mtight"},[i("span",{staticClass:"mord mtight"},[s._v("′")])])])])])])])])]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord mathnormal"},[s._v("x")]),i("span",{staticClass:"mclose"},[s._v(")")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord text"},[i("span",{staticClass:"mord"},[s._v("sigmoid")])]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord mathnormal"},[s._v("x")]),i("span",{staticClass:"mclose"},[s._v(")")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),i("span",{staticClass:"minner"},[i("span",{staticClass:"mopen delimcenter",staticStyle:{top:"0em"}},[s._v("(")]),i("span",{staticClass:"mord"},[s._v("1")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[s._v("−")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mord text"},[i("span",{staticClass:"mord"},[s._v("sigmoid")])]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord mathnormal"},[s._v("x")]),i("span",{staticClass:"mclose"},[s._v(")")]),i("span",{staticClass:"mclose delimcenter",staticStyle:{top:"0em"}},[s._v(")")])])])])])])]),s._v(" "),i("p",[s._v("下面绘制了sigmoid函数的导数。当输入为0时，sigmoid函数的导数达到最大值0.25；当输入越偏离0时，sigmoid函数的导数越接近0。")]),s._v(" "),i("div",{staticClass:"language-python line-numbers-mode"},[i("pre",{pre:!0,attrs:{class:"language-python"}},[i("code",[s._v("x "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Variable"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cast"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dtype"),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("float32"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GradientTape"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" tape"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    y "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("nn"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sigmoid"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xlabel"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x"')]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ylabel"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token string"}},[s._v('"(reLU x)\\\'"')]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ngrad "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tape"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gradient"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("y"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plot"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("numpy"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" grad"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("show"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),i("div",{staticClass:"line-numbers-wrapper"},[i("span",{staticClass:"line-number"},[s._v("1")]),i("br"),i("span",{staticClass:"line-number"},[s._v("2")]),i("br"),i("span",{staticClass:"line-number"},[s._v("3")]),i("br"),i("span",{staticClass:"line-number"},[s._v("4")]),i("br"),i("span",{staticClass:"line-number"},[s._v("5")]),i("br"),i("span",{staticClass:"line-number"},[s._v("6")]),i("br"),i("span",{staticClass:"line-number"},[s._v("7")]),i("br"),i("span",{staticClass:"line-number"},[s._v("8")]),i("br")])]),i("p",[i("img",{attrs:{src:a(405),alt:""}})]),s._v(" "),i("h3",{attrs:{id:"tanh函数"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#tanh函数"}},[s._v("#")]),s._v(" tanh函数")]),s._v(" "),i("p",[s._v("tanh（双曲正切）函数可以将元素的值变换到-1和1之间：")]),s._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mtext",[s._v("tanh")]),i("mo",{attrs:{stretchy:"false"}},[s._v("(")]),i("mi",[s._v("x")]),i("mo",{attrs:{stretchy:"false"}},[s._v(")")]),i("mo",[s._v("=")]),i("mfrac",[i("mrow",[i("mn",[s._v("1")]),i("mo",[s._v("−")]),i("mi",[s._v("exp")]),i("mo",[s._v("⁡")]),i("mo",{attrs:{stretchy:"false"}},[s._v("(")]),i("mo",[s._v("−")]),i("mn",[s._v("2")]),i("mi",[s._v("x")]),i("mo",{attrs:{stretchy:"false"}},[s._v(")")])],1),i("mrow",[i("mn",[s._v("1")]),i("mo",[s._v("+")]),i("mi",[s._v("exp")]),i("mo",[s._v("⁡")]),i("mo",{attrs:{stretchy:"false"}},[s._v("(")]),i("mo",[s._v("−")]),i("mn",[s._v("2")]),i("mi",[s._v("x")]),i("mo",{attrs:{stretchy:"false"}},[s._v(")")])],1)],1),i("mi",{attrs:{mathvariant:"normal"}},[s._v(".")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\text{tanh}(x) = \\frac{1 - \\exp(-2x)}{1 + \\exp(-2x)}.\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mord text"},[i("span",{staticClass:"mord"},[s._v("tanh")])]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord mathnormal"},[s._v("x")]),i("span",{staticClass:"mclose"},[s._v(")")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"2.363em","vertical-align":"-0.936em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mopen nulldelimiter"}),i("span",{staticClass:"mfrac"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.427em"}},[i("span",{staticStyle:{top:"-2.314em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[s._v("1")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[s._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mop"},[s._v("exp")]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord"},[s._v("−")]),i("span",{staticClass:"mord"},[s._v("2")]),i("span",{staticClass:"mord mathnormal"},[s._v("x")]),i("span",{staticClass:"mclose"},[s._v(")")])])]),i("span",{staticStyle:{top:"-3.23em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),i("span",{staticStyle:{top:"-3.677em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[s._v("1")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[s._v("−")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mop"},[s._v("exp")]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord"},[s._v("−")]),i("span",{staticClass:"mord"},[s._v("2")]),i("span",{staticClass:"mord mathnormal"},[s._v("x")]),i("span",{staticClass:"mclose"},[s._v(")")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.936em"}},[i("span")])])])]),i("span",{staticClass:"mclose nulldelimiter"})]),i("span",{staticClass:"mord"},[s._v(".")])])])])])]),s._v(" "),i("p",[s._v("我们接着绘制tanh函数。当输入接近0时，tanh函数接近线性变换。虽然该函数的形状和sigmoid函数的形状很像，但tanh函数在坐标系的原点上对称。")]),s._v(" "),i("p",[s._v("这段代码将会打印tanh的图像：")]),s._v(" "),i("div",{staticClass:"language-python line-numbers-mode"},[i("pre",{pre:!0,attrs:{class:"language-python"}},[i("code",[i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" tensorflow "),i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" tf\n"),i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" matplotlib"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pyplot "),i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" plt\n\nx "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("constant"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("range")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),i("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),i("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),i("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nx "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cast"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("dtype"),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("float32"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nout "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("nn"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tanh"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xlabel"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x"')]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ylabel"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token string"}},[s._v('"reLU x"')]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plot"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" out"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("show"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),i("div",{staticClass:"line-numbers-wrapper"},[i("span",{staticClass:"line-number"},[s._v("1")]),i("br"),i("span",{staticClass:"line-number"},[s._v("2")]),i("br"),i("span",{staticClass:"line-number"},[s._v("3")]),i("br"),i("span",{staticClass:"line-number"},[s._v("4")]),i("br"),i("span",{staticClass:"line-number"},[s._v("5")]),i("br"),i("span",{staticClass:"line-number"},[s._v("6")]),i("br"),i("span",{staticClass:"line-number"},[s._v("7")]),i("br"),i("span",{staticClass:"line-number"},[s._v("8")]),i("br"),i("span",{staticClass:"line-number"},[s._v("9")]),i("br"),i("span",{staticClass:"line-number"},[s._v("10")]),i("br")])]),i("p",[i("img",{attrs:{src:a(406),alt:""}})]),s._v(" "),i("p",[s._v("老规矩打印tanh梯度的图像：")]),s._v(" "),i("div",{staticClass:"language-python line-numbers-mode"},[i("pre",{pre:!0,attrs:{class:"language-python"}},[i("code",[s._v("x "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Variable"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cast"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dtype"),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("float32"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GradientTape"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),i("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" tape"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    y "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tf"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("nn"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tanh"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xlabel"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x"')]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ylabel"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token string"}},[s._v('"(reLU x)\\\'"')]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ngrad "),i("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tape"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gradient"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("y"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plot"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("numpy"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" grad"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nplt"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("show"),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),i("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),i("div",{staticClass:"line-numbers-wrapper"},[i("span",{staticClass:"line-number"},[s._v("1")]),i("br"),i("span",{staticClass:"line-number"},[s._v("2")]),i("br"),i("span",{staticClass:"line-number"},[s._v("3")]),i("br"),i("span",{staticClass:"line-number"},[s._v("4")]),i("br"),i("span",{staticClass:"line-number"},[s._v("5")]),i("br"),i("span",{staticClass:"line-number"},[s._v("6")]),i("br"),i("span",{staticClass:"line-number"},[s._v("7")]),i("br"),i("span",{staticClass:"line-number"},[s._v("8")]),i("br")])]),i("p",[i("img",{attrs:{src:a(407),alt:""}})]),s._v(" "),i("h2",{attrs:{id:"回到多层感知机"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#回到多层感知机"}},[s._v("#")]),s._v(" 回到多层感知机")]),s._v(" "),i("p",[s._v("多层感知机就是含有至少一个隐藏层的由全连接层组成的神经网络，且每个隐藏层的输出通过激活函数进行变换。多层感知机的层数和各隐藏层中隐藏单元个数都是超参数。以单隐藏层为例并沿用本节之前定义的符号，多层感知机按以下方式计算输出：")]),s._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mtable",{attrs:{rowspacing:"0.2500em",columnalign:"right",columnspacing:""}},[i("mtr",[i("mtd",[i("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[i("mtable",{attrs:{rowspacing:"0.2500em",columnalign:"right left",columnspacing:"0em"}},[i("mtr",[i("mtd",[i("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("H")])],1)],1),i("mtd",[i("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[i("mrow",[i("mrow"),i("mo",[s._v("=")]),i("mi",[s._v("ϕ")]),i("mo",{attrs:{stretchy:"false"}},[s._v("(")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("X")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("W")]),i("mi",[s._v("h")])],1),i("mo",[s._v("+")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("b")]),i("mi",[s._v("h")])],1),i("mo",{attrs:{stretchy:"false"}},[s._v(")")]),i("mo",{attrs:{separator:"true"}},[s._v(",")])],1)],1)],1)],1),i("mtr",[i("mtd",[i("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("O")])],1)],1),i("mtd",[i("mstyle",{attrs:{scriptlevel:"0",displaystyle:"true"}},[i("mrow",[i("mrow"),i("mo",[s._v("=")]),i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("H")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("W")]),i("mi",[s._v("o")])],1),i("mo",[s._v("+")]),i("msub",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("b")]),i("mi",[s._v("o")])],1),i("mo",{attrs:{separator:"true"}},[s._v(",")])],1)],1)],1)],1)],1)],1)],1)],1)],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\begin{split}\\begin{aligned}\n\\boldsymbol{H} &= \\phi(\\boldsymbol{X} \\boldsymbol{W}_h + \\boldsymbol{b}_h),\\\\\n\\boldsymbol{O} &= \\boldsymbol{H} \\boldsymbol{W}_o + \\boldsymbol{b}_o,\n\\end{aligned}\\end{split}\n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"3.3000000000000007em","vertical-align":"-1.4000000000000001em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mtable"},[i("span",{staticClass:"col-align-r"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.9000000000000006em"}},[i("span",{staticStyle:{top:"-3.9em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3.75em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mtable"},[i("span",{staticClass:"col-align-r"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.7500000000000002em"}},[i("span",{staticStyle:{top:"-3.91em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.08229em"}},[s._v("H")])])])])]),i("span",{staticStyle:{top:"-2.41em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.03194em"}},[s._v("O")])])])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.2500000000000002em"}},[i("span")])])])]),i("span",{staticClass:"col-align-l"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.7500000000000002em"}},[i("span",{staticStyle:{top:"-3.91em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"}),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mord mathnormal"},[s._v("ϕ")]),i("span",{staticClass:"mopen"},[s._v("(")]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.07778em"}},[s._v("X")])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[s._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[s._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[s._v("b")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.33610799999999996em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("h")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mclose"},[s._v(")")]),i("span",{staticClass:"mpunct"},[s._v(",")])])]),i("span",{staticStyle:{top:"-2.41em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"}),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[s._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.08229em"}},[s._v("H")])])]),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.15972em"}},[s._v("W")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[s._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol"},[s._v("b")])])]),i("span",{staticClass:"msupsub"},[i("span",{staticClass:"vlist-t vlist-t2"},[i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.151392em"}},[i("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[i("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),i("span",{staticClass:"sizing reset-size6 size3 mtight"},[i("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[i("span")])])])])]),i("span",{staticClass:"mpunct"},[s._v(",")])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.2500000000000002em"}},[i("span")])])])])])])])])]),i("span",{staticClass:"vlist-s"},[s._v("​")])]),i("span",{staticClass:"vlist-r"},[i("span",{staticClass:"vlist",staticStyle:{height:"1.4000000000000001em"}},[i("span")])])])])])])])])])])]),s._v(" "),i("p",[s._v("其中"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",[s._v("ϕ")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\phi")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.8888799999999999em","vertical-align":"-0.19444em"}}),i("span",{staticClass:"mord mathnormal"},[s._v("ϕ")])])])]),s._v("表示激活函数。在分类问题中，我们可以对输出"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("O")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\boldsymbol{O}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.68611em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.03194em"}},[s._v("O")])])])])])]),s._v("做softmax运算，并使用softmax回归中的交叉熵损失函数。 在回归问题中，我们将输出层的输出个数设为1，并将输出"),i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[i("semantics",[i("mrow",[i("mi",{attrs:{mathvariant:"bold-italic"}},[s._v("O")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\boldsymbol{O}")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.68611em","vertical-align":"0em"}}),i("span",{staticClass:"mord"},[i("span",{staticClass:"mord"},[i("span",{staticClass:"mord boldsymbol",staticStyle:{"margin-right":"0.03194em"}},[s._v("O")])])])])])]),s._v("直接提供给线性回归中使用的平方损失函数。")]),s._v(" "),i("h2",{attrs:{id:"小结"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),i("ul",[i("li",[s._v("多层感知机在输出层与输入层之间加入了一个或多个全连接隐藏层，并通过激活函数对隐藏层输出进行变换。")]),s._v(" "),i("li",[s._v("常用的激活函数包括ReLU函数、sigmoid函数和tanh函数。")])])])}),[],!1,null,null,null);t.default=n.exports}}]);